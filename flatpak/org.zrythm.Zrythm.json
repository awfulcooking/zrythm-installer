{
    "app-id": "org.zrythm.Zrythm",
    "runtime": "org.gnome.Platform",
    "runtime-version": "44",
    "sdk": "org.gnome.Sdk",
    "command": "zrythm_launch",
    "rename-icon": "zrythm",
    "copy-icon": true,
    "finish-args": [
        "--share=ipc",
        "--socket=x11",
        "--share=network",
        "--socket=pulseaudio",
        "--device=all",
        "--filesystem=home",
        "--filesystem=xdg-run/pipewire-0",
        "--system-talk-name=org.freedesktop.RealtimeKit1"
    ],
    "add-extensions": {
        "org.freedesktop.LinuxAudio.Plugins": {
            "directory": "extensions/Plugins",
            "version": "22.08",
            "add-ld-path": "lib",
            "merge-dirs": "ladspa;dssi;lv2;vst;vst3",
            "subdirectories": true,
            "no-autodownload": true
        }
    },
    "cleanup": [
        "/include",
        "/lib/pkgconfig",
        "/man",
        "/share/doc",
        "/share/gtk-doc",
        "/share/man",
        "/share/pkgconfig",
        "*.la",
        "*.a"
    ],
    "modules": [
        {
            "name": "vamp-plugin-sdk",
            "buildsystem": "autotools",
            "no-parallel-make": true,
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/c4dm/vamp-plugin-sdk",
                    "commit": "67adfc2bf9486912a0fce5123cf54360ea2678bc",
                    "tag": "vamp-plugin-sdk-v2.10",
                    "x-checker-data": {
                        "type": "git",
                        "tag-pattern": "^vamp-plugin-sdk-v([\\d.]+)$"
                    }
                }
            ],
            "post-install": [
                "install -Dm644 -t /app/share/licenses/vamp-plugin-sdk COPYING"
            ],
            "cleanup": [
                "/bin",
                "/include",
                "/lib/pkgconfig"
            ]
        },
        "shared-modules/linux-audio/lv2.json",
        {
          "name": "lilv",
          "buildsystem": "meson",
          "modules": [
            {
              "name": "serd",
              "buildsystem": "meson",
              "sources": [
                {
                  "type": "archive",
                  "url": "https://download.drobilla.net/serd-0.30.16.tar.xz",
                  "sha256": "f50f486da519cdd8d03b20c9e42414e459133f5a244411d8e63caef8d9ac9146"
                }
              ],
              "cleanup": [
                "/bin",
                "/include",
                "/lib/pkgconfig",
                "/share/man"
              ]
            },
            {
              "name": "sord",
              "buildsystem": "meson",
              "sources": [
                {
                  "type": "archive",
                  "url": "https://download.drobilla.net/sord-0.16.14.tar.xz",
                  "sha256": "220fd97d5fcb216e7b85db66f685bfdaad7dc58a50d1f96dfb2558dbc6c4731b"
                }
              ],
              "cleanup": [
                "/bin",
                "/include",
                "/lib/pkgconfig",
                "/share/man"
              ]
            },
            {
              "name": "sratom",
              "buildsystem": "meson",
              "cleanup": [
                "/include",
                "/lib/pkgconfig"
              ],
              "sources": [
                {
                  "type": "archive",
                  "url": "https://download.drobilla.net/sratom-0.6.14.tar.xz",
                  "sha256": "9982faf40db83aedd9b3850e499fecd6852b8b4ba6dede514013655cffaca1e6"
                }
              ]
            }
          ],
          "sources": [
            {
              "type": "archive",
              "url": "https://download.drobilla.net/lilv-0.24.20.tar.xz",
              "sha256": "4fb082b9b8b286ea92bbb71bde6b75624cecab6df0cc639ee75a2a096212eebc"
            }
          ],
          "cleanup": [
            "/bin",
            "/etc",
            "/lib/pkgconfig",
            "/share/man"
          ]
        },
        "shared-modules/linux-audio/fftw3f.json",
        {
            "name": "jack2",
            "buildsystem": "simple",
            "build-commands": [
                "./waf configure --prefix=$FLATPAK_DEST --htmldir=$FLATPAK_DEST/share/doc/jack/ --classic",
                "./waf build -j $FLATPAK_BUILDER_N_JOBS",
                "./waf install"
            ],
            "cleanup": [
                "/include",
                "/lib/jack",
                "/lib/libjack*",
                "/lib/pkgconfig",
                "/share/man"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/jackaudio/jack2/archive/v1.9.17.tar.gz",
                    "sha256": "38f674bbc57852a8eb3d9faa1f96a0912d26f7d5df14c11005ad499c8ae352f2"
                }
            ]
        },
        "shared-modules/linux-audio/liblo.json",
        {
            "name": "bdwgc",
            "buildsystem": "autotools",
            "build-options": {
                "no-debuginfo": true
            },
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/ivmai/bdwgc.git",
                    "commit": "cd1fbc1dbfd2cc888436944dd2784f39820698d7",
                    "tag": "v8.2.2",
                    "x-checker-data": {
                        "type": "json",
                        "url": "https://api.github.com/repos/ivmai/bdwgc/releases/latest",
                        "tag-query": ".tag_name",
                        "version-query": "$tag | sub(\"^jq-\"; \"\")",
                        "timestamp-query": ".published_at"
                    }
                }
            ],
            "cleanup": [
                "*.a",
                "*.la",
                "/include",
                "/share/info",
                "/share/doc",
                "/lib/pkgconfig"
            ]
        },
        {
            "name": "guile",
            "buildsystem": "autotools",
            "cleanup": [
                "/bin",
                "/lib/libguile-3.0.so.1.5.0-gdb.scm"
            ],
            "build-options": {
                "no-debuginfo": true
            },
            "sources": [
                {
                    "type": "archive",
                    "url": "https://ftp.gnu.org/gnu/guile/guile-3.0.8.tar.xz",
                    "sha256": "daa7060a56f2804e9b74c8d7e7fe8beed12b43aab2789a38585183fcc17b8a13",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 1277,
                        "stable-only": true,
                        "url-template": "https://ftp.gnu.org/gnu/guile/guile-$version.tar.xz"
                    }
                }
            ],
            "modules": [
                {
                    "name": "libatomic_ops",
                    "buildsystem": "autotools",
                    "build-options": {
                        "no-debuginfo": true
                    },
                    "sources": [
                        {
                            "type": "git",
                            "url": "https://github.com/ivmai/libatomic_ops",
                            "commit": "7c5a50620b9216e7364c215ecde1120747c3708d",
                            "tag": "v7.6.14",
                            "x-checker-data": {
                                "type": "json",
                                "url": "https://api.github.com/repos/ivmai/libatomic_ops/releases/latest",
                                "tag-query": ".tag_name",
                                "version-query": "$tag | sub(\"^jq-\"; \"\")",
                                "timestamp-query": ".published_at"
                            }
                        }
                    ],
                    "cleanup": [
                        "*.a",
                        "*.la",
                        "/include",
                        "/share/info",
                        "/share/man",
                        "/share/aclocal",
                        "/lib/pkgconfig"
                    ]
                }
            ]
        },
        {
            "name": "libaudec",
            "buildsystem": "meson",
            "build-options": {
                "no-debuginfo": true
            },
            "sources": [
                {
                    "type": "git",
                    "url": "https://git.sr.ht/~alextee/libaudec",
                    "commit": "46f5aa04316f94bfbfa90d6b3514df54e90f0602"
                }
            ]
        },
        {
            "name": "carla",
            "buildsystem": "simple",
            "build-commands": [
                "make PREFIX=/app -j $FLATPAK_BUILDER_N_JOBS",
                "make PREFIX=/app install"
            ],
            "build-options": {
                "arch": {
                    "aarch64": {
                        "env": {
                            "NOOPT": "true"
                        }
                    }
                },
                "no-debuginfo": true
            },
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/falkTX/Carla/",
                    "commit": "@CARLA_GIT_VER@"
                }
            ]
        },
        {
            "name": "xxHash",
            "buildsystem": "simple",
            "build-commands": [
                "make PREFIX=/app -j $FLATPAK_BUILDER_N_JOBS",
                "make PREFIX=/app install"
            ],
            "build-options": {
                "no-debuginfo": true
            },
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/Cyan4973/xxHash/",
                    "commit": "b1a61dff654af43552b5ee05c737b6fd2a0ee14b"
                }
            ]
        },
        {
            "name": "libcyaml",
            "buildsystem": "simple",
            "build-options": {
                "no-debuginfo": true
            },
            "build-commands": [
                "make PREFIX=/app -j $FLATPAK_BUILDER_N_JOBS",
                "make PREFIX=/app install"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/tlsa/libcyaml",
                    "commit": "ee6231ff844c7f100e3b4e65fa34ed47f8fb2f49",
                    "tag": "v1.3.1",
                    "x-checker-data": {
                        "type": "json",
                        "url": "https://api.github.com/repos/tlsa/libcyaml/releases/latest",
                        "tag-query": ".tag_name",
                        "version-query": "$tag | sub(\"^jq-\"; \"\")",
                        "timestamp-query": ".published_at"
                    }
                }
            ],
            "modules": [
                {
                    "name": "libyaml",
                    "build-options": {
                        "no-debuginfo": true
                    },
                    "buildsystem": "autotools",
                    "sources": [
                        {
                            "type": "git",
                            "url": "https://github.com/yaml/libyaml",
                            "commit": "2c891fc7a770e8ba2fec34fc6b545c672beb37e6",
                            "tag": "0.2.5",
                            "x-checker-data": {
                                "type": "json",
                                "url": "https://api.github.com/repos/yaml/libyaml/releases/latest",
                                "tag-query": ".tag_name",
                                "version-query": "$tag | sub(\"^jq-\"; \"\")",
                                "timestamp-query": ".published_at"
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "backtrace",
            "buildsystem": "autotools",
            "build-options": {
                "env": {
                    "CFLAGS": "-fPIC"
                },
                "no-debuginfo": true
            },
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/ianlancetaylor/libbacktrace",
                    "commit": "d0f5e95a87a4d3e0a1ed6c069b5dae7cbab3ed2a"
                }
            ]
        },
        {
            "name": "rubberband",
            "build-options": {
                "no-debuginfo": true
            },
            "buildsystem": "meson",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://breakfastquay.com/files/releases/rubberband-3.1.2.tar.bz2",
                    "sha256": "dda7e257b14c59a1f59c5ccc4d6f19412039f77834275955aa0ff511779b98d2",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 4222,
                        "stable-only": true,
                        "url-template": "https://breakfastquay.com/files/releases/rubberband-$version.tar.bz2"
                    }
                }
            ],
            "cleanup": [
                "/bin",
                "/include",
                "/share/ladspa",
                "*.a",
                "*.so"
            ]
        },
        {
            "name": "reproc",
            "buildsystem": "cmake-ninja",
            "build-options": {
                "env": {
                    "BUILD_SHARED_LIBS": "ON",
                    "REPROC_WARNINGS": "ON",
                    "REPROC_WARNINGS_AS_ERRORS": "ON",
                    "CFLAGS": "-fPIC"
                },
                "no-debuginfo": true
            },
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/DaanDeMeyer/reproc",
                    "commit": "8aea3aef64c37a7ed0db759a7128a80c2540c808",
                    "tag": "v14.2.4"
                }
            ]
        },
        {
            "name": "breeze-icons",
            "builddir": true,
            "buildsystem": "simple",
            "build-options": {
                "no-debuginfo": true
            },
            "build-commands": [
                "mkdir -p /app/share/icons/breeze-dark",
                "cp -r icons-dark/* /app/share/icons/breeze-dark"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.kde.org/stable/frameworks/5.103/breeze-icons-5.103.0.tar.xz",
                    "sha256": "7925d70ef2078316f69b9d26e7b1536844fb1d3c045fc78a2464c54871415abd",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 305788,
                        "stable-only": true,
                        "url-template": "https://download.kde.org/stable/frameworks/$major.$minor/breeze-icons-$version.tar.xz"
                    }
                }
            ]
        },
        {
            "name": "lsp-dsp-lib",
            "buildsystem": "simple",
            "build-options": {
                "no-debuginfo": true
            },
            "build-commands": [
                "make PREFIX=/app config",
                "make PREFIX=/app -j $FLATPAK_BUILDER_N_JOBS",
                "make PREFIX=/app install"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/lsp-plugins/lsp-dsp-lib/releases/download/1.0.9/lsp-dsp-lib-src-1.0.9.tar.gz",
                    "sha256": "a333fb70c92d92366bfb8de8278b97d32e26e4804c4737df6ab565069f63b862",
                    "x-checker-data": {
                        "type": "json",
                        "url": "https://api.github.com/repos/lsp-plugins/lsp-dsp-lib/releases/latest",
                        "version-query": ".tag_name",
                        "url-query": ".assets[] | select(.name==\"lsp-dsp-lib-src-\" + $version + \".tar.gz\") | .browser_download_url"
                    }
                }
            ]
        },
        {
            "name": "rtaudio",
            "buildsystem": "meson",
            "config-opts": [
                "-Djack=disabled",
                "-Dalsa=disabled"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://www.music.mcgill.ca/~gary/rtaudio/release/rtaudio-5.2.0.tar.gz",
                    "sha256": "d6089c214e5dbff136ab21f3f5efc284e93475ebd198c54d4b9b6c44419ef4e6"
                }
            ]
        },
        {
            "name": "sassc",
            "cleanup": [
                "*"
            ],
            "buildsystem": "autotools",
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/sass/sassc",
                    "commit": "66f0ef37e7f0ad3a65d2f481eff09d09408f42d0",
                    "tag": "3.6.2",
                    "x-checker-data": {
                        "type": "json",
                        "url": "https://api.github.com/repos/sass/sassc/releases/latest",
                        "tag-query": ".tag_name",
                        "version-query": "$tag | sub(\"^jq-\"; \"\")",
                        "timestamp-query": ".published_at"
                    }
                },
                {
                    "type": "script",
                    "dest-filename": "autogen.sh",
                    "commands": [
                        "autoreconf -si"
                    ]
                }
            ],
            "modules": [
                {
                    "name": "libsass",
                    "cleanup": [
                        "*"
                    ],
                    "buildsystem": "autotools",
                    "sources": [
                        {
                            "type": "git",
                            "url": "https://github.com/sass/libsass",
                            "commit": "f6afdbb9288d20d1257122e71d88e53348a53af3",
                            "tag": "3.6.5",
                            "x-checker-data": {
                                "type": "json",
                                "url": "https://api.github.com/repos/sass/libsass/releases/latest",
                                "tag-query": ".tag_name",
                                "version-query": "$tag | sub(\"^jq-\"; \"\")",
                                "timestamp-query": ".published_at"
                            }
                        },
                        {
                            "type": "script",
                            "dest-filename": "autogen.sh",
                            "commands": [
                                "autoreconf -si"
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "boost",
            "buildsystem": "simple",
            "build-commands": [
                "./bootstrap.sh --prefix=${FLATPAK_DEST}",
                "./b2 -j $FLATPAK_BUILDER_N_JOBS headers",
                "mkdir -p ${FLATPAK_DEST}/include/boost",
                "cp -r boost/* ${FLATPAK_DEST}/include/boost"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://boostorg.jfrog.io/artifactory/main/release/1.78.0/source/boost_1_78_0.tar.bz2",
                    "sha256": "8681f175d4bdb26c52222665793eef08490d7758529330f98d3b29dd0735bccc"
                }
            ]
        },
        {
            "name": "libadwaita",
            "buildsystem": "meson",
            "build-options": {
                "no-debuginfo": true
            },
            "config-opts": [
                "-Dintrospection=disabled",
                "-Dgtk_doc=false",
                "-Dtests=false",
                "-Dexamples=false",
                "-Dvapi=false"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://gitlab.gnome.org/GNOME/libadwaita",
                    "commit": "a905117bd2150de9e85d65f8cdce8d8fb001b89e"
                }
            ],
            "cleanup": [
                "/include",
                "/lib/pkgconfig"
            ],
            "modules": [
                {
                    "name": "pango",
                    "buildsystem": "meson",
                    "build-options": {
                        "no-debuginfo": true
                    },
                    "config-opts": [
                        "-Dinstall-tests=false",
                        "-Dgtk_doc=false"
                    ],
                    "sources": [
                        {
                            "type": "git",
                            "url": "https://gitlab.gnome.org/GNOME/pango",
                            "commit": "8d4e58f15b6d608d1da7268371f7efde7b35e950"
                        }
                    ],
                    "cleanup": [
                        "/include",
                        "/bin/pango-*"
                    ]
                },
                {
                    "name": "gtk",
                    "buildsystem": "meson",
                    "build-options": {
                        "no-debuginfo": true
                    },
                    "config-opts": [
                        "-Dmedia-gstreamer=disabled",
                        "-Dprint-cups=disabled",
                        "-Dintrospection=disabled",
                        "-Dgtk_doc=false",
                        "-Dbuild-tests=false",
                        "-Dbuild-examples=false"
                    ],
                    "sources": [
                        {
                            "type": "git",
                            "url": "https://gitlab.gnome.org/GNOME/gtk",
                            "commit": "3a941eff4aa0ad66e0aa34e6528bc4d78c5e5d5e"
                        }
                    ],
                    "cleanup": [
                        "/include",
                        "/bin/gtk4-*"
                    ]
                },
                {
                    "name": "gtksourceview",
                    "buildsystem": "meson",
                    "build-options": {
                        "env": {
                            "LIBRARY_PATH": "/app/lib"
                        },
                        "no-debuginfo": true
                    },
                    "config-opts": [
                        "-Dvapi=false",
                        "-Dintrospection=disabled"
                    ],
                    "sources": [
                        {
                            "type": "git",
                            "url": "https://gitlab.gnome.org/GNOME/gtksourceview",
                            "commit": "ec0b434c4ebea7e9c1920013af2a911c4b28a66a"
                        }
                    ]
                }
            ]
        },
        {
            "name": "zix",
            "buildsystem": "meson",
            "config-opts": [
                "-Dbenchmarks=disabled",
                "-Dtests=disabled",
                "-Ddefault_library=static",
                "-Ddocs=disabled"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/drobilla/zix",
                    "commit": "56ec14c4369c591f5efbb500b0829b760bee7800"
                }
            ]
        },
        {
            "name": "libpanel",
            "buildsystem": "meson",
            "config-opts": [
                "-Dvapi=false",
                "-Dinstall-examples=false",
                "-Dintrospection=disabled",
                "-Ddocs=disabled"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://git.sr.ht/~alextee/libpanel-detach",
                    "commit": "86a41374dcb061a5007d24041b42a1823a8abc8d"
                }
            ]
        },
        {
            "name": "zrythm",
            "builddir": true,
            "buildsystem": "meson",
            "config-opts": [
                "-Dflatpak=true",
                "-Dfallback_version=@ZRYTHM_PKG_SEMVER_VERSION@",
                "-Dtrial_ver=@TRIAL_TRUE_FALSE@",
                "-Dcheck_updates=true",
                "-Dinstaller_ver=true",
                "-Djack=enabled",
                "-Dalsa=disabled",
                "-Drtaudio=enabled"
            ],
            "build-options": {
                "env": {
                    "LIBRARY_PATH": "/app/lib"
                },
                "no-debuginfo": true
            },
            "post-install": [
                "install -d /app/extensions/Plugins"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://git.sr.ht/~alextee/zrythm",
                    "commit": "@ZRYTHM_GIT_VERSION@",
                    "x-checker-data": {
                        "type": "git",
                        "tag-pattern": "^v(.*[\\d.]+)$"
                    }
                }
            ]
        },
        {
            "name": "demo-projects",
            "buildsystem": "simple",
            "build-commands": [
                "mkdir -p ${FLATPAK_DEST}/share/zrythm/templates/demo_zsong01",
                "cp -r ./* ${FLATPAK_DEST}/share/zrythm/templates/demo_zsong01/"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://www.zrythm.org/demo-projects/demo_zsong01.zip",
                    "sha256": "bca4afaf63c294cfb2a91a965e1f51e90bea29c3c09b2b3bb164b4330ac29159"
                }
            ]
        }
    ]
}
