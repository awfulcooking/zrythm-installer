#!/usr/bin/make -f

%:
	dh $@

override_dh_auto_configure:
	mkdir -p debian/build
	cd debian/build && PKG_CONFIG_PATH=/usr/lib/zrythm/lib/pkgconfig ../../../../meson/meson.py --prefix=/usr ../.. -Dtests=true -Ddseg_font=false -Dmanpage=true -Dbuildtype=release -Dffmpeg=enabled -Dsdl=enabled -Drtaudio=auto -Drtmidi=auto -Dguile=enabled -Dcarla=enabled -Dgraphviz=enabled

override_dh_auto_build:
	cd debian/build && ninja -v

override_dh_auto_test:
	echo test # cd debian/build && ninja test

override_dh_auto_install:
	cd debian/build && DESTDIR=${CURDIR}/debian/zrythm ninja install
	mkdir -p ${CURDIR}/debian/zrythm/usr/lib/zrythm/lib
	cp -RLv /usr/lib/zrythm/lib/carla ${CURDIR}/debian/zrythm/usr/lib/zrythm/lib/
	if [ ! -f ${CURDIR}/debian/zrythm/usr/lib/zrythm/lib/carla/libcarla_native-plugin.so ] ; then exit -1 ; fi
